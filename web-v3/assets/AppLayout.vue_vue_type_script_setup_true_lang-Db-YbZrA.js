import{a as A,b as L,u as N,c as U}from"./main-DDo7BXaU.js";import{d as R,s as E}from"./pinia-DVfpTBqr.js";import{r as x,c as k,d as b,l as r,m as e,G as f,e as a,U as S,f as u,H as _,N as $,O as w,M as H,u as Q,o as j,t as C,R as V}from"./main-C-FGy421.js";const T=R("scripts",()=>{const p=x([]),n=x(null),o=x(!1),i=x(null),d=x(""),c=k(()=>(d.value?p.value.filter(s=>s.name.toLowerCase().includes(d.value.toLowerCase())):p.value).reduce((s,y)=>{const g=y.group||"Ungrouped";return s[g]||(s[g]=[]),s[g].push(y),s},{})),l=k(()=>Object.keys(c.value).sort((s,y)=>s==="Ungrouped"?1:y==="Ungrouped"?-1:s.localeCompare(y)));async function m(t){o.value=!0,i.value=null;try{const s=await A.getScripts(t);p.value=s.scripts}catch(s){i.value=s instanceof Error?s.message:"Failed to load scripts"}finally{o.value=!1}}function h(t){n.value=t}function v(t){d.value=t}return{scripts:p,selectedScript:n,loading:o,error:i,searchQuery:d,groupedScripts:c,sortedGroups:l,loadScripts:m,selectScript:h,setSearchQuery:v}}),B={class:"p-3 border-b border-gray-200 dark:border-gray-700"},G={class:"relative"},M=["value"],D=b({__name:"SearchPanel",props:{modelValue:{}},emits:["update:modelValue"],setup(p,{emit:n}){const o=n,i=x();function d(){var c;o("update:modelValue",""),(c=i.value)==null||c.focus()}return(c,l)=>(a(),r("div",B,[e("div",G,[l[2]||(l[2]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 material-icons text-lg"}," search ",-1)),e("input",{ref_key:"inputRef",ref:i,type:"text",value:p.modelValue,onInput:l[0]||(l[0]=m=>o("update:modelValue",m.target.value)),placeholder:"Search scripts...",class:"w-full pl-10 pr-8 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-sm text-gray-800 dark:text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/50"},null,40,M),p.modelValue?(a(),r("button",{key:0,onClick:d,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...l[1]||(l[1]=[e("span",{class:"material-icons text-lg"},"close",-1)])])):f("",!0)])]))}}),F={class:"flex flex-col h-full"},O={key:0,class:"p-4 text-center text-gray-500"},P={key:1,class:"p-4 text-center text-gray-500"},z={class:"text-sm"},I={key:2,class:"flex-1 overflow-auto py-2"},q={key:0,class:"px-4 py-1 text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},J=["onClick"],K={class:"material-icons text-lg"},W={class:"truncate"},X={key:0,class:"ml-auto text-xs text-red-500",title:"Configuration error"},Y=b({__name:"ScriptsList",setup(p){const n=L(),o=N(),i=T(),{groupedScripts:d,sortedGroups:c,loading:l,searchQuery:m}=E(i);function h(t){i.selectScript(t),n.push({name:"script",params:{name:t}})}function v(t){return o.params.name===t}return(t,s)=>(a(),r("div",F,[S(D,{"model-value":u(m),"onUpdate:modelValue":u(i).setSearchQuery},null,8,["model-value","onUpdate:modelValue"]),u(l)?(a(),r("div",O,[...s[0]||(s[0]=[e("span",{class:"material-icons animate-spin"},"refresh",-1),e("p",{class:"mt-2 text-sm"},"Loading scripts...",-1)])])):u(c).length===0?(a(),r("div",P,[s[1]||(s[1]=e("span",{class:"material-icons text-4xl mb-2"},"folder_off",-1)),e("p",z,_(u(m)?"No scripts match your search":"No scripts available"),1)])):(a(),r("div",I,[(a(!0),r($,null,w(u(c),y=>(a(),r("div",{key:y,class:"mb-2"},[u(c).length>1||y!=="Ungrouped"?(a(),r("div",q,_(y),1)):f("",!0),(a(!0),r($,null,w(u(d)[y],g=>(a(),r("button",{key:g.name,onClick:me=>h(g.name),class:H(["w-full px-4 py-2 text-left flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",{"bg-primary/10 text-primary border-r-2 border-primary":v(g.name),"text-gray-700 dark:text-gray-300":!v(g.name)}])},[e("span",K,_(g.parsing_failed?"error":"description"),1),e("span",W,_(g.name),1),g.parsing_failed?(a(),r("span",X," Error ")):f("",!0)],10,J))),128))]))),128))]))]))}}),Z=["title"],ee={class:"material-icons"},te=b({__name:"ThemeToggle",setup(p){const{currentTheme:n,toggleTheme:o}=Q(),i={light:"light_mode",dark:"dark_mode",system:"contrast"},d={light:"Light mode",dark:"Dark mode",system:"System theme"};return(c,l)=>(a(),r("button",{onClick:l[0]||(l[0]=(...m)=>u(o)&&u(o)(...m)),class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400",title:d[u(n)]},[e("span",ee,_(i[u(n)]),1)],8,Z))}}),se={class:"w-72 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col"},re={class:"flex-1 overflow-auto"},ae={class:"border-t border-gray-200 dark:border-gray-700 p-4 space-y-2"},oe={key:0,class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-3"},ne={class:"flex items-center gap-2"},le={key:0,class:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded"},ie={class:"flex items-center gap-2"},ce=b({__name:"MainAppSidebar",setup(p){const n=L(),o=U(),i=T(),d=k(()=>o.username),c=k(()=>o.isAdmin);j(()=>{i.loadScripts()});function l(){o.logout()}function m(){window.location.href="/admin.html"}function h(){n.push("/history")}return(v,t)=>(a(),r("aside",se,[t[4]||(t[4]=e("div",{class:"h-16 flex items-center px-4 border-b border-gray-200 dark:border-gray-700"},[e("h1",{class:"text-xl font-medium text-primary"}," Script Server ")],-1)),e("div",re,[S(Y)]),e("div",ae,[d.value?(a(),r("div",oe,[e("span",ne,[t[0]||(t[0]=e("span",{class:"material-icons text-lg"},"person",-1)),C(" "+_(d.value),1)]),c.value?(a(),r("span",le," Admin ")):f("",!0)])):f("",!0),e("div",ie,[e("button",{onClick:h,class:"flex-1 btn btn-secondary text-sm flex items-center justify-center gap-1",title:"Execution History"},[...t[1]||(t[1]=[e("span",{class:"material-icons text-lg"},"history",-1),C(" History ",-1)])]),S(te),c.value?(a(),r("button",{key:0,onClick:m,class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400",title:"Admin Panel"},[...t[2]||(t[2]=[e("span",{class:"material-icons"},"settings",-1)])])):f("",!0),e("button",{onClick:l,class:"p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400",title:"Logout"},[...t[3]||(t[3]=[e("span",{class:"material-icons"},"logout",-1)])])])])]))}}),de={class:"flex h-screen bg-gray-50 dark:bg-gray-900"},ue={class:"flex-1 flex flex-col overflow-hidden"},pe={key:0,class:"bg-white dark:bg-gray-800 shadow-sm"},ge={class:"flex-1 overflow-auto bg-gray-50 dark:bg-gray-900"},_e=b({__name:"AppLayout",setup(p){return(n,o)=>(a(),r("div",de,[S(ce),e("div",ue,[n.$slots.header?(a(),r("header",pe,[V(n.$slots,"header")])):f("",!0),e("main",ge,[V(n.$slots,"content")])])]))}});export{_e as _};
