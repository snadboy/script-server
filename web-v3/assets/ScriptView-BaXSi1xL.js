var pe=Object.defineProperty;var ye=(n,t,e)=>t in n?pe(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var V=(n,t,e)=>ye(n,typeof t!="symbol"?t+"":t,e);import{a as z,u as ve}from"./main-DDo7BXaU.js";import{_ as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-Db-YbZrA.js";import{r as $,c as S,w as H,j as re,d as O,l as h,e as g,G as C,m as y,t as N,H as L,M as D,N as R,O as q,I as be,a as G,P as ke,Q as we,R as _e,f as T,o as oe,S as ue,T as Ce,J as X,K as Se,n as ie,U as Y,V as ae,W as Le,L as $e}from"./main-C-FGy421.js";import{d as Z,s as U}from"./pinia-DVfpTBqr.js";import"./index-B9ygI19o.js";const ee=Z("scriptConfig",()=>{const n=$(null),t=$([]),e=$(!1),s=$(null),r=$(!1);let u=null,f=0,m=[];const v=S(()=>{var d;return((d=n.value)==null?void 0:d.name)||null}),w=S(()=>{var d;return((d=n.value)==null?void 0:d.outputFormat)||"terminal"}),b=S(()=>{var d;return((d=n.value)==null?void 0:d.schedulingEnabled)||!1});function x(d){const a=window.location.protocol==="https:"?"wss:":"ws:",p=window.location.host;return`${a}//${p}/scripts/${encodeURIComponent(d)}`}function c(d){k(),e.value=!0,s.value=null;try{u=new WebSocket(x(d)),u.onopen=()=>{for(r.value=!0;m.length>0;){const a=m.shift();a!==void 0&&(u==null||u.send(JSON.stringify(a)))}},u.onclose=a=>{r.value=!1,e.value=!1,a.code===401||a.code===4001?(s.value="Unauthorized",window.location.href="/login.html"):a.code===403||a.code===4003?s.value="Access denied":(a.code===404||a.code===4004)&&(s.value="Script not found")},u.onerror=()=>{s.value="Connection error",e.value=!1},u.onmessage=a=>{try{const p=JSON.parse(a.data);l(p)}catch(p){console.error("Failed to parse WebSocket message:",p)}}}catch(a){s.value=a instanceof Error?a.message:"Failed to connect",e.value=!1}}function l(d){switch(d.event){case"initialConfig":n.value=d.data,t.value=d.data.parameters||[],e.value=!1;break;case"reloadedConfig":n.value=d.data,t.value=d.data.parameters||[];break;case"parameterChanged":{const a=d.data,p=t.value.findIndex(_=>_.name===a.name);p!==-1&&(t.value[p]=a);break}case"parameterAdded":{const a=d.data;t.value.push(a);break}case"parameterRemoved":{const a=d.data.parameterName,p=t.value.findIndex(_=>_.name===a);p!==-1&&t.value.splice(p,1);break}}d.clientStateVersion!==void 0&&(f=d.clientStateVersion)}function i(d,a){f++;const p={event:"parameterValue",data:{parameter:d,value:a,clientStateVersion:f}};u&&u.readyState===WebSocket.OPEN?u.send(JSON.stringify(p)):m.push(p)}function o(d){var p;f++;const a={event:"reloadModelValues",data:{parameterValues:d,clientModelId:(p=n.value)==null?void 0:p.id,clientStateVersion:f}};u&&u.readyState===WebSocket.OPEN?u.send(JSON.stringify(a)):m.push(a)}function k(){u&&(u.close(),u=null),n.value=null,t.value=[],r.value=!1,e.value=!1,s.value=null,f=0,m=[]}return{config:n,parameters:t,loading:e,error:s,connected:r,scriptName:v,outputFormat:w,schedulingEnabled:b,connect:c,disconnect:k,sendParameterValue:i,reloadModel:o}}),ce=Z("scriptSetup",()=>{const n=ee(),t=$({}),e=$({}),s=$([]),r=S(()=>Object.values(e.value).some(l=>l!==null)),u=S(()=>{for(const l of n.parameters)if(l.required){const i=t.value[l.name];if(i==null||i==="")return!1}return!r.value});H(()=>n.parameters,l=>{f(l)},{immediate:!0});function f(l){for(const o of l)t.value[o.name]===void 0&&(t.value[o.name]=m(o));const i=new Set(l.map(o=>o.name));for(const o of Object.keys(t.value))i.has(o)||(delete t.value[o],delete e.value[o])}function m(l){if(l.default!==void 0)return l.default;switch(l.type){case"multiselect":return[];case"file_upload":return null;default:return l.withoutValue?!1:""}}function v(l,i){t.value[l]=i,n.sendParameterValue(l,i);const o=n.parameters.find(k=>k.name===l);o&&w(o,i)}function w(l,i){if(e.value[l.name]=null,l.required){if(i==null||i===""){e.value[l.name]="This field is required";return}if(Array.isArray(i)&&i.length===0){e.value[l.name]="Please select at least one option";return}}if(l.type==="int"&&i!==""&&i!==null){const o=Number(i);if(isNaN(o)){e.value[l.name]="Must be a number";return}if(l.min!==void 0&&o<l.min){e.value[l.name]=`Minimum value is ${l.min}`;return}if(l.max!==void 0&&o>l.max){e.value[l.name]=`Maximum value is ${l.max}`;return}}}function b(l,i){if(i&&!s.value.includes(l))s.value.push(l);else if(!i){const o=s.value.indexOf(l);o!==-1&&s.value.splice(o,1)}}function x(){t.value={},e.value={},s.value=[],f(n.parameters)}function c(){const l=new FormData;for(const i of n.parameters){const o=t.value[i.name];if(o!=null){if(o instanceof File){l.append(i.name,o);continue}if(Array.isArray(o)){for(const k of o)l.append(i.name,String(k));continue}if(typeof o=="boolean"){o&&l.append(i.name,"true");continue}o!==""&&l.append(i.name,String(o))}}return l}return{parameterValues:t,errors:e,forcedValueParameters:s,hasErrors:r,isValid:u,setValue:v,setForced:b,reset:x,buildFormData:c}}),de=Z("executionManager",()=>{const n=$(new Map),t=$(null),e=$(new Map),s=S(()=>t.value&&n.value.get(t.value)||null),r=S(()=>Array.from(n.value.values()).filter(d=>d.status==="initializing"||d.status==="executing")),u=S(()=>r.value.length>0);function f(d){const a=window.location.protocol==="https:"?"wss:":"ws:",p=window.location.host;return`${a}//${p}/executions/io/${d}`}async function m(d,a){const p=await z.startExecution(d,a),_=re({id:p,scriptName:d,status:"initializing",logChunks:[],inputPromptText:null,downloadableFiles:[],inlineImages:{},killEnabled:!1,exitCode:null,error:null});return n.value.set(p,_),t.value=p,v(p,_),p}function v(d,a){const p=new WebSocket(f(d));p.onopen=()=>{a.status="executing"},p.onclose=_=>{e.value.delete(d),(a.status==="executing"||a.status==="initializing")&&(_.code===401||_.code===4001?(a.status="error",a.error="Unauthorized"):_.code===403||_.code===4003?(a.status="error",a.error="Access denied"):_.code===404||_.code===4004?(a.status="error",a.error="Execution not found"):_.code===1e3?a.status="finished":a.status="disconnected")},p.onerror=()=>{a.status="error",a.error="Connection error"},p.onmessage=_=>{try{const A=JSON.parse(_.data);w(a,A)}catch{a.logChunks.push({text:_.data,timestamp:Date.now()})}},e.value.set(d,p)}function w(d,a){switch(a.event){case"output":d.logChunks.push({text:a.data,timestamp:Date.now()});break;case"input":d.inputPromptText=a.data;break;case"file":{const p=a.data;d.downloadableFiles.push(p);break}case"inline-image":{const p=a.data;d.inlineImages[p.output_path]=p.download_url;break}}}function b(d,a){const p=e.value.get(d);p&&p.readyState===WebSocket.OPEN&&p.send(a);const _=n.value.get(d);_&&(_.inputPromptText=null)}async function x(d){await z.stopExecution(d)}async function c(d){await z.killExecution(d)}function l(d){n.value.has(d)&&(t.value=d)}function i(d){const a=e.value.get(d);if(a&&(a.close(),e.value.delete(d)),n.value.delete(d),t.value===d){const p=Array.from(n.value.keys());t.value=p.length>0?p[0]:null}}async function o(){try{const d=await z.getActiveExecutions();for(const a of d)if(!n.value.has(a)){const p=await z.getExecutionConfig(a),_=re({id:a,scriptName:p.scriptName,status:"executing",logChunks:[],inputPromptText:null,downloadableFiles:[],inlineImages:{},killEnabled:!1,exitCode:null,error:null});n.value.set(a,_),v(a,_)}!t.value&&n.value.size>0&&(t.value=Array.from(n.value.keys())[0])}catch(d){console.error("Failed to reconnect active executions:",d)}}function k(){for(const d of e.value.values())d.close();e.value.clear(),n.value.clear(),t.value=null}return{executions:n,selectedExecutionId:t,selectedExecution:s,activeExecutions:r,hasActiveExecutions:u,startExecution:m,sendInput:b,stopExecution:x,killExecution:c,selectExecution:l,closeExecution:i,reconnectActiveExecutions:o,clearAll:k}}),Pe={class:"mb-4"},Ee={key:0,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ve={key:0,class:"text-red-500"},Te=["type","value","placeholder","disabled","required","min","max","maxlength"],Ie={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Me={key:2,class:"mt-1 text-xs text-red-500"},Ae=O({__name:"TextField",props:{modelValue:{},config:{},label:{},type:{default:"text"},placeholder:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,s=t,r=$(),u=$(null),f=S(()=>{var c;return e.label||((c=e.config)==null?void 0:c.name)||""}),m=S(()=>e.error||u.value),v=S(()=>{var c;return e.required||((c=e.config)==null?void 0:c.required)}),w=S(()=>{var c,l;return(c=e.config)!=null&&c.secure?"password":((l=e.config)==null?void 0:l.type)==="int"?"number":e.type});function b(c){const l=c.target;let i=l.value;w.value==="number"&&i!==""&&(i=Number(i)),s("update:modelValue",i),x(l.value)}function x(c){var l,i,o;if(u.value=null,v.value&&!c){u.value="This field is required";return}if(((l=e.config)==null?void 0:l.type)==="int"&&c){const k=Number(c);if(isNaN(k)){u.value="Must be a number";return}if(e.config.min!==void 0&&k<e.config.min){u.value=`Minimum value is ${e.config.min}`;return}if(e.config.max!==void 0&&k>e.config.max){u.value=`Maximum value is ${e.config.max}`;return}}if((i=e.config)!=null&&i.maxLength&&c.length>e.config.maxLength){u.value=`Maximum length is ${e.config.maxLength}`;return}if((o=e.config)!=null&&o.regex&&c&&!new RegExp(e.config.regex).test(c)){u.value="Invalid format";return}}return(c,l)=>{var i,o,k,d,a;return g(),h("div",Pe,[f.value?(g(),h("label",Ee,[N(L(f.value)+" ",1),v.value?(g(),h("span",Ve,"*")):C("",!0)])):C("",!0),y("input",{ref_key:"inputRef",ref:r,type:w.value,value:n.modelValue,placeholder:n.placeholder||((i=n.config)==null?void 0:i.description),disabled:n.disabled,required:v.value,min:(o=n.config)==null?void 0:o.min,max:(k=n.config)==null?void 0:k.max,maxlength:(d=n.config)==null?void 0:d.maxLength,class:D(["w-full px-3 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"border-gray-300 dark:border-gray-600":!m.value,"border-red-500":m.value}]),onInput:b},null,42,Te),(a=n.config)!=null&&a.description&&!m.value?(g(),h("p",Ie,L(n.config.description),1)):C("",!0),m.value?(g(),h("p",Me,L(m.value),1)):C("",!0)])}}}),Fe={class:"mb-4"},Ne={key:0,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Re={key:0,class:"text-red-500"},Oe=["value","placeholder","rows","disabled","required","maxlength"],De={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},qe={key:2,class:"mt-1 text-xs text-red-500"},Be=O({__name:"TextArea",props:{modelValue:{},config:{},label:{},placeholder:{},rows:{default:4},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,s=t,r=$(null),u=S(()=>{var b;return e.label||((b=e.config)==null?void 0:b.name)||""}),f=S(()=>e.error||r.value),m=S(()=>{var b;return e.required||((b=e.config)==null?void 0:b.required)});function v(b){const x=b.target;s("update:modelValue",x.value),w(x.value)}function w(b){var x;if(r.value=null,m.value&&!b){r.value="This field is required";return}if((x=e.config)!=null&&x.maxLength&&b.length>e.config.maxLength){r.value=`Maximum length is ${e.config.maxLength}`;return}}return(b,x)=>{var c,l,i;return g(),h("div",Fe,[u.value?(g(),h("label",Ne,[N(L(u.value)+" ",1),m.value?(g(),h("span",Re,"*")):C("",!0)])):C("",!0),y("textarea",{value:n.modelValue,placeholder:n.placeholder||((c=n.config)==null?void 0:c.description),rows:n.rows,disabled:n.disabled,required:m.value,maxlength:(l=n.config)==null?void 0:l.maxLength,class:D(["w-full px-3 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed resize-y font-mono text-sm",{"border-gray-300 dark:border-gray-600":!f.value,"border-red-500":f.value}]),onInput:v},null,42,Oe),(i=n.config)!=null&&i.description&&!f.value?(g(),h("p",De,L(n.config.description),1)):C("",!0),f.value?(g(),h("p",qe,L(f.value),1)):C("",!0)])}}}),He={class:"mb-4 flex items-start gap-3"},Ue=["checked","disabled"],je={class:"flex-1"},We={class:"text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer"},ze={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},Ke=O({__name:"Checkbox",props:{modelValue:{type:Boolean},config:{},label:{},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,s=t,r=S(()=>{var f;return e.label||((f=e.config)==null?void 0:f.name)||""});function u(f){const m=f.target;s("update:modelValue",m.checked)}return(f,m)=>{var v;return g(),h("div",He,[y("input",{type:"checkbox",checked:n.modelValue,disabled:n.disabled,class:"mt-1 h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-primary focus:ring-primary/50 bg-white dark:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",onChange:u},null,40,Ue),y("div",je,[y("label",We,L(r.value),1),(v=n.config)!=null&&v.description?(g(),h("p",ze,L(n.config.description),1)):C("",!0)])])}}}),Je={class:"mb-4"},Ge={key:0,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Xe={key:0,class:"text-red-500"},Ye=["value","multiple","disabled","required"],Qe={key:0,value:""},Ze=["value","selected"],et={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},tt={key:2,class:"mt-1 text-xs text-red-500"},nt=O({__name:"Combobox",props:{modelValue:{},config:{},label:{},options:{},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,s=t,r=$(null),u=S(()=>{var c;return e.label||((c=e.config)==null?void 0:c.name)||""}),f=S(()=>e.error||r.value),m=S(()=>{var c;return e.required||((c=e.config)==null?void 0:c.required)}),v=S(()=>{var c;return e.multiple||((c=e.config)==null?void 0:c.type)==="multiselect"}),w=S(()=>{var c;return e.options||((c=e.config)==null?void 0:c.values)||[]});function b(c){const l=c.target;if(v.value){const i=Array.from(l.selectedOptions).map(o=>o.value);s("update:modelValue",i)}else s("update:modelValue",l.value);x(l.value)}function x(c){r.value=null,m.value&&!c&&(r.value="Please select an option")}return(c,l)=>{var i;return g(),h("div",Je,[u.value?(g(),h("label",Ge,[N(L(u.value)+" ",1),m.value?(g(),h("span",Xe,"*")):C("",!0)])):C("",!0),y("select",{value:v.value?void 0:n.modelValue,multiple:v.value,disabled:n.disabled,required:m.value,class:D(["w-full px-3 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed",{"border-gray-300 dark:border-gray-600":!f.value,"border-red-500":f.value,"h-32":v.value}]),onChange:b},[!v.value&&!m.value?(g(),h("option",Qe," -- Select -- ")):C("",!0),(g(!0),h(R,null,q(w.value,o=>{var k;return g(),h("option",{key:o,value:o,selected:v.value?(k=n.modelValue)==null?void 0:k.includes(o):n.modelValue===o},L(o),9,Ze)}),128))],42,Ye),(i=n.config)!=null&&i.description&&!f.value?(g(),h("p",et,L(n.config.description),1)):C("",!0),f.value?(g(),h("p",tt,L(f.value),1)):C("",!0)])}}}),st={class:"mb-4"},lt={key:0,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},rt={key:0,class:"text-red-500"},it=["accept","disabled"],at={key:0,class:"flex items-center justify-center gap-2"},ot={class:"text-sm text-gray-700 dark:text-gray-300 truncate max-w-xs"},ut={key:1,class:"text-gray-500 dark:text-gray-400"},ct={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},dt={key:2,class:"mt-1 text-xs text-red-500"},ft=O({__name:"FileUpload",props:{modelValue:{},config:{},label:{},accept:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,s=t,r=$(),u=$(null),f=$(!1),m=S(()=>{var a;return e.label||((a=e.config)==null?void 0:a.name)||""}),v=S(()=>e.error||u.value),w=S(()=>{var a;return e.required||((a=e.config)==null?void 0:a.required)}),b=S(()=>{var a;return((a=e.modelValue)==null?void 0:a.name)||null});function x(a){var A;const _=((A=a.target.files)==null?void 0:A[0])||null;s("update:modelValue",_),d(_)}function c(a){var _,A;a.preventDefault(),f.value=!1;const p=((A=(_=a.dataTransfer)==null?void 0:_.files)==null?void 0:A[0])||null;p&&(s("update:modelValue",p),d(p))}function l(a){a.preventDefault(),f.value=!0}function i(){f.value=!1}function o(){s("update:modelValue",null),r.value&&(r.value.value="")}function k(){var a;(a=r.value)==null||a.click()}function d(a){u.value=null,w.value&&!a&&(u.value="Please select a file")}return(a,p)=>{var _;return g(),h("div",st,[m.value?(g(),h("label",lt,[N(L(m.value)+" ",1),w.value?(g(),h("span",rt,"*")):C("",!0)])):C("",!0),y("input",{ref_key:"inputRef",ref:r,type:"file",accept:n.accept,disabled:n.disabled,class:"hidden",onChange:x},null,40,it),y("div",{class:D(["relative border-2 border-dashed rounded-lg p-4 text-center transition-colors cursor-pointer",{"border-gray-300 dark:border-gray-600 hover:border-primary":!f.value&&!v.value,"border-primary bg-primary/5":f.value,"border-red-500":v.value,"opacity-50 cursor-not-allowed":n.disabled}]),onClick:p[0]||(p[0]=A=>!n.disabled&&k()),onDrop:p[1]||(p[1]=A=>!n.disabled&&c(A)),onDragover:p[2]||(p[2]=A=>!n.disabled&&l(A)),onDragleave:i},[b.value?(g(),h("div",at,[p[4]||(p[4]=y("span",{class:"material-icons text-primary"},"description",-1)),y("span",ot,L(b.value),1),y("button",{type:"button",class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",onClick:be(o,["stop"])},[...p[3]||(p[3]=[y("span",{class:"material-icons text-gray-500 text-lg"},"close",-1)])])])):(g(),h("div",ut,[...p[5]||(p[5]=[y("span",{class:"material-icons text-3xl mb-2"},"cloud_upload",-1),y("p",{class:"text-sm"},"Drop a file here or click to browse",-1)])]))],34),(_=n.config)!=null&&_.description&&!v.value?(g(),h("p",ct,L(n.config.description),1)):C("",!0),v.value?(g(),h("p",dt,L(v.value),1)):C("",!0)])}}}),gt={class:"space-y-4"},ht={key:0,class:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4"},mt={key:0,class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-4"},pt={key:0,class:"text-center py-8 text-gray-500 dark:text-gray-400"},yt=O({__name:"ScriptParametersView",setup(n){const t=ee(),e=ce(),{parameters:s}=U(t),{parameterValues:r,errors:u,forcedValueParameters:f}=U(e),m=["list","multiselect","editable_list"];function v(l){return l.withoutValue?Ke:m.includes(l.type)?nt:l.type==="file_upload"?ft:l.type==="multiline_text"?Be:Ae}function w(l){const i={config:l,modelValue:r.value[l.name],error:u.value[l.name]||void 0,disabled:f.value.includes(l.name)};return l.type==="multiselect"?{...i,multiple:!0}:i}function b(l,i){e.setValue(l,i)}function x(l){return!l.requiredParameters||l.requiredParameters.length===0?!0:l.requiredParameters.every(i=>{const o=r.value[i];return o!=null&&o!==""&&o!==!1})}const c=S(()=>s.value.filter(x));return(l,i)=>(g(),h("div",gt,[(g(!0),h(R,null,q(c.value,o=>{var k;return g(),h("div",{key:o.name,class:"transition-all duration-200"},[(k=o.ui)!=null&&k.separatorBefore?(g(),h("div",ht,[o.ui.separatorBefore.title?(g(),h("h3",mt,L(o.ui.separatorBefore.title),1)):C("",!0)])):C("",!0),(g(),G(ke(v(o)),we({ref_for:!0},w(o),{"onUpdate:modelValue":d=>b(o.name,d)}),null,16,["onUpdate:modelValue"]))])}),128)),c.value.length===0?(g(),h("div",pt,[...i[0]||(i[0]=[y("span",{class:"material-icons text-4xl mb-2"},"tune",-1),y("p",null,"No parameters required for this script",-1)])])):C("",!0)]))}}),vt={key:0,class:"flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 overflow-x-auto"},xt=["onClick"],bt={class:"max-w-[150px] truncate"},kt={class:"text-xs text-gray-400"},wt=["onClick"],_t=O({__name:"ExecutionInstanceTabs",setup(n){const t=de(),{executions:e,selectedExecutionId:s}=U(t),r=S(()=>Array.from(e.value.values())),u=S(()=>r.value.length>0);function f(b){switch(b.status){case"executing":return"sync";case"finished":return"check_circle";case"error":return"error";case"disconnected":return"link_off";default:return"pending"}}function m(b){switch(b.status){case"executing":return"text-blue-500";case"finished":return"text-green-500";case"error":return"text-red-500";case"disconnected":return"text-gray-500";default:return"text-gray-400"}}function v(b){t.selectExecution(b)}function w(b,x){b.stopPropagation(),t.closeExecution(x)}return(b,x)=>u.value?(g(),h("div",vt,[(g(!0),h(R,null,q(r.value,c=>(g(),h("button",{key:c.id,class:D(["flex items-center gap-2 px-3 py-1.5 rounded-t text-sm whitespace-nowrap transition-colors",[T(s)===c.id?"bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"]]),onClick:l=>v(c.id)},[y("span",{class:D(["material-icons text-base",[m(c),{"animate-spin":c.status==="executing"}]])},L(f(c)),3),y("span",bt,L(c.scriptName),1),y("span",kt," #"+L(c.id.slice(0,6)),1),y("button",{class:"ml-1 p-0.5 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Close",onClick:l=>w(l,c.id)},[...x[0]||(x[0]=[y("span",{class:"material-icons text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}," close ",-1)])],8,wt)],10,xt))),128)),_e(b.$slots,"controls")])):C("",!0)}}),Ct=new Set(["0","1","2","3","4","5","6","7","8","9"]);function St(n){return Ct.has(n)}function Q(n,t,e,s){const r=n.length;if(e>=r){n.push(t);return}if(e>=s){const m=n[e];m<t?n.splice(e+1,0,t):m>t&&n.splice(e,0,t);return}const u=Math.floor((s+e)/2),f=n[u];f!==t&&(f<t?Q(n,t,u+1,s):Q(n,t,e,u-1))}class te{constructor(t){V(this,"color",null);V(this,"background",null);V(this,"styles",[]);t&&(t.color!==void 0&&(this.color=t.color),t.background!==void 0&&(this.background=t.background),t.styles&&t.styles.length>0&&this.styles.push(...t.styles))}clone(){const t=new te;return t.color=this.color,t.background=this.background,t.styles=[...this.styles],t}isEmpty(){return this.color===null&&this.background===null&&this.styles.length===0}equals(t){return this.color===t.color&&this.background===t.background&&Vt(this.styles,t.styles)}}class K{constructor(t,e,s){V(this,"start");V(this,"end");V(this,"style");this.start=t,this.end=e,this.style=s}}class Lt{constructor(){V(this,"listeners",[]);V(this,"lines",[]);V(this,"inlineImages",{});V(this,"lineStyles",new Map);V(this,"currentLine",0);V(this,"currentPosition",0);V(this,"maxLine",0);V(this,"buffer","");V(this,"currentStyle",null);V(this,"changedLines",[]);V(this,"savedCursorPosition",null);this.clear()}addListener(t){this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e!==-1&&this.listeners.splice(e,1)}write(t){const e=this.buffer+t;let s=0,r=null,u="";for(let m=0;m<e.length;m++){const v=e[m];if(r!==null){r+=v;let w=!0;if(r.length===2)w=v==="[";else if(r.length>2&&F.has(v)){const b=Pt(r.substring(2,r.length-1));r=null,this.handleCommand(b,v),w=!1}else w=St(v)||v===";";w||(r!==null&&(this.flushText(r),r=null),s=m)}else v===Ot?(this.flushText(u),u="",r=v):v===`
`?(this.flushText(u),u="",this.currentPosition=0,this.currentLine++,this.maxLine=Math.max(this.maxLine,this.currentLine),s=m):v==="\r"?(this.flushText(u),u="",this.currentPosition=0,s=m):(u+=v,s=m)}this.flushText(u),this.buffer=e.substring(s+1);const f=this.changedLines;if(this.changedLines=[],f.length>0)for(const m of this.listeners)m.linesChanges(f)}clear(){this.lines=[],this.inlineImages={},this.lineStyles=new Map,this.currentLine=0,this.currentPosition=0,this.maxLine=0,this.buffer="",this.currentStyle=null,this.changedLines=[],this.savedCursorPosition=null;for(const t of this.listeners)t.cleared()}clearFullLine(){this.lines[this.currentLine]="",this.addChangedLine(this.currentLine)}clearLineToRight(){const t=this.getLine(this.currentLine);t.length<=this.currentPosition||(this.lines[this.currentLine]=t.substring(0,this.currentPosition),this.addChangedLine(this.currentLine))}clearLineToLeft(t){if(t===0)return;const e=this.getLine(this.currentLine);if(e.length<=t){this.lines[this.currentLine]="",this.addChangedLine(this.currentLine);return}const s=" ".repeat(t);this.lines[this.currentLine]=s+e.substring(t),this.addChangedLine(this.currentLine)}deleteBottomLines(t){const e=this.lines.length;if(!(e<=t)){for(let s=t;s<=this.lines.length;s++)this.lineStyles.delete(s);for(let s=this.changedLines.length-1;s>=0&&this.changedLines[s]>=t;s--)this.changedLines.splice(s,1);this.lines=this.lines.slice(0,t),this.maxLine=Math.max(0,t-1),this.savedCursorPosition=null;for(const s of this.listeners)s.linesDeleted(t,e)}}deleteTopLines(t){if(!(t<=0)){for(let e=0;e<t;e++)this.lineStyles.delete(e);for(let e=0;e<this.lines.length;e++){const s=e+t;this.lineStyles.has(s)&&(this.lineStyles.set(e,this.lineStyles.get(s)),this.lineStyles.delete(s))}this.lines=this.lines.slice(t),this.currentLine=Math.max(0,this.currentLine-t),this.savedCursorPosition=null,this.maxLine=Math.max(0,this.lines.length-1),this.changedLines=[];for(const e of this.listeners)e.cleared();for(let e=0;e<this.lines.length;e++)this.changedLines.push(e)}}getStyle(t){return this.lineStyles.get(t)}flushText(t){if(t.length===0)return;const e=this.getLine(this.currentLine);this.lines[this.currentLine]=$t(e,this.currentPosition,t);const s=this.currentPosition+t.length;this.updateTextStyle(this.currentLine,this.currentPosition,s,this.currentStyle),this.currentPosition=s,this.addChangedLine(this.currentLine)}addChangedLine(t){Q(this.changedLines,t,0,this.changedLines.length)}getLine(t){let e=this.lines.length;for(;e<=t;)this.lines.push(""),e++;return this.lines[t]}setStyle(t){t.isEmpty()?this.currentStyle=null:this.currentStyle=t}setCursorPosition(t,e){this.currentLine=t,this.currentPosition=e}handleCommand(t,e){const s=F.get(e);s&&s.isValidArgumentsCount(t.length)&&s.handle(t,this)}updateTextStyle(t,e,s,r){const u=r===null||r.isEmpty();if(!this.lineStyles.has(t)){u||this.lineStyles.set(t,[new K(e,s,r)]);return}const f=this.lineStyles.get(t);let m=0;for(;m<f.length&&f[m].end<=e;)m++;if(m>=f.length){u||f.push(new K(e,s,r));return}const v=f[m];if(v.start<e){if(m++,v.end>s){f.splice(m,0,new K(e,s,r)),f.splice(m+1,0,new K(s,v.end,v.style)),v.end=e;return}v.end=e}for(f.splice(m,0,new K(e,s,r)),m++;m<f.length;){const w=f[m];if(w.end<=s)f.splice(m,1);else{if(w.start>=s)return;w.start=s;return}}}removeInlineImage(t){Object.prototype.hasOwnProperty.call(this.inlineImages,t)&&(delete this.inlineImages[t],this.notifyInlineImageChange(t))}setInlineImage(t,e){this.inlineImages[t]=e,this.notifyInlineImageChange(t)}notifyInlineImageChange(t){const e=[];for(let s=0;s<this.lines.length;s++)this.lines[s].includes(t)&&e.push(s);if(e.length>0)for(const s of this.listeners)s.linesChanges(e)}}function $t(n,t,e){return n.length<t?n+" ".repeat(t-n.length)+e:n.length===t?n+e:n.substring(0,t)+e+n.substring(t+e.length)}function Pt(n){const t=Et(n,";"),e=[];for(const s of t){if(s===""){e.push(0);continue}const r=parseInt(s,10);r<0||isNaN(r)||e.push(r)}return e}function Et(n,t){if(n==="")return[""];const e=[];let s=0;for(let r=0;r<n.length;r++)if(n[r]===t){const f=n.substring(s,r);s=r+1,e.push(f)}if(s<n.length){const r=n.substring(s,n.length);e.push(r)}return e}function Vt(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Tt(n,t){const e=n.indexOf(t);e!==-1&&n.splice(e,1)}function It(n,t){return n.indexOf(t)!==-1}class B{constructor(t=1,e=1){V(this,"minArgumentsCount");V(this,"maxArgumentsCount");this.minArgumentsCount=t,this.maxArgumentsCount=e}isValidArgumentsCount(t){return this.minArgumentsCount<=t&&t<=this.maxArgumentsCount}}class Mt extends B{constructor(){super(1,10)}handle(t,e){const s=It(t,0),r=e.currentStyle;let u=s||r==null?new te:r.clone();for(const f of t)I.has(f)?u.color=I.get(f):M.has(f)?u.background=M.get(f):j.has(f)?u.styles.push(j.get(f)):W.has(f)&&Tt(u.styles,W.get(f));e.setStyle(u)}}class fe extends B{constructor(e){super();V(this,"moveUp");this.moveUp=e}handle(e,s){const r=e[0];let u;this.moveUp?u=Math.max(0,s.currentLine-r):u=Math.min(s.currentLine+r,s.maxLine),s.setCursorPosition(u,s.currentPosition)}}class ge extends B{constructor(e){super();V(this,"moveRight");this.moveRight=e}handle(e,s){const r=e[0];let u;this.moveRight?u=s.currentPosition+r:u=Math.max(0,s.currentPosition-r),s.setCursorPosition(s.currentLine,u)}}class he extends B{constructor(){super(1,2)}handle(t,e){const s=Math.min(t[0],e.maxLine);let r;if(t.length===1?r=0:r=t[1],r<0||s<0){console.log("Negative line/column are not allowed: were "+s+";"+r);return}e.setCursorPosition(s,r)}}class At extends B{handle(t,e){e.savedCursorPosition=[e.currentLine,e.currentPosition]}}class Ft extends B{handle(t,e){if(e.savedCursorPosition===null){console.log("WARN! trying to restore cursor position, but nothing is saved");return}const[s,r]=e.savedCursorPosition;e.setCursorPosition(s,r)}}class Nt extends B{constructor(){super()}handle(t,e){const s=t[0];s===0?e.clearLineToRight():s===1?e.clearLineToLeft(e.currentPosition):s===2?e.clearFullLine():console.log("WARN! Unsupported ["+s+"K command")}}class Rt extends B{constructor(){super()}handle(t,e){const s=t[0];s===0?e.deleteBottomLines(e.currentLine+1):s===1?(e.deleteTopLines(e.currentLine),e.clearLineToLeft(e.currentPosition+1)):s===2||s===3?e.clear():console.log("WARN! Unsupported ["+s+"J command")}}const F=new Map;F.set("m",new Mt);F.set("K",new Nt);F.set("J",new Rt);F.set("H",new he);F.set("f",new he);F.set("A",new fe(!0));F.set("B",new fe(!1));F.set("C",new ge(!0));F.set("D",new ge(!1));F.set("s",new At);F.set("u",new Ft);const I=new Map;I.set(39,null);I.set(31,"red");I.set(30,"black");I.set(32,"green");I.set(33,"yellow");I.set(34,"blue");I.set(35,"magenta");I.set(36,"cyan");I.set(37,"lightgray");I.set(90,"darkgray");I.set(91,"lightred");I.set(92,"lightgreen");I.set(93,"lightyellow");I.set(94,"lightblue");I.set(95,"lightmagenta");I.set(96,"lightcyan");I.set(97,"white");const M=new Map;M.set(49,null);M.set(41,"red");M.set(40,"black");M.set(42,"green");M.set(43,"yellow");M.set(44,"blue");M.set(45,"magenta");M.set(46,"cyan");M.set(47,"lightgray");M.set(100,"darkgray");M.set(101,"lightred");M.set(102,"lightgreen");M.set(103,"lightyellow");M.set(104,"lightblue");M.set(105,"lightmagenta");M.set(106,"lightcyan");M.set(107,"white");const j=new Map;j.set(1,"bold");j.set(2,"dim");j.set(4,"underlined");j.set(8,"hidden");const W=new Map;W.set(21,"bold");W.set(22,"dim");W.set(24,"underlined");W.set(28,"hidden");const Ot="\x1B",Dt={class:"terminal-output font-mono text-sm leading-relaxed"},qt={key:0,class:"mt-4 space-y-2"},Bt=["src","alt"],Ht={key:1,class:"text-gray-500 italic"},Ut=O({__name:"TerminalOutput",props:{logChunks:{},inlineImages:{default:()=>({})}},setup(n){const t=n,e=new Lt,s=$([]),r=$(new Map);let u=0;const f={linesChanges(c){for(const l of c)s.value[l]=e.lines[l]||"";r.value=new Map(e.lineStyles)},cleared(){s.value=[],r.value=new Map,u=0},linesDeleted(c,l){s.value=s.value.slice(0,c),r.value=new Map(e.lineStyles)}},m={red:"#f44336",black:"#000000",green:"#4caf50",yellow:"#ffeb3b",blue:"#2196f3",magenta:"#e91e63",cyan:"#00bcd4",lightgray:"#9e9e9e",darkgray:"#616161",lightred:"#ef5350",lightgreen:"#66bb6a",lightyellow:"#ffee58",lightblue:"#42a5f5",lightmagenta:"#ec407a",lightcyan:"#26c6da",white:"#ffffff"};function v(c){return c&&m[c]||""}function w(c){const l=[];for(const i of c)switch(i){case"bold":l.push("font-bold");break;case"dim":l.push("opacity-50");break;case"underlined":l.push("underline");break;case"hidden":l.push("invisible");break}return l.join(" ")}function b(c){const l=s.value[c]||"",i=r.value.get(c);if(!i||i.length===0)return[{text:l||`
`}];const o=[];let k=0;for(const d of i){d.start>k&&o.push({text:l.substring(k,d.start)});const a=[],p=[];d.style&&(d.style.color&&a.push(`color: ${v(d.style.color)}`),d.style.background&&a.push(`background-color: ${v(d.style.background)}`),d.style.styles.length>0&&p.push(w(d.style.styles))),o.push({text:l.substring(d.start,d.end),style:a.join("; "),classes:p.join(" ")}),k=d.end}return k<l.length&&o.push({text:l.substring(k)}),o.length===0||o.length===1&&o[0].text===""?[{text:`
`}]:o}H(()=>t.logChunks,c=>{for(let l=u;l<c.length;l++)e.write(c[l].text);u=c.length},{deep:!0}),H(()=>t.inlineImages,c=>{for(const[l,i]of Object.entries(c))e.setInlineImage(l,i)},{deep:!0,immediate:!0}),oe(()=>{e.addListener(f);for(const c of t.logChunks)e.write(c.text);u=t.logChunks.length}),ue(()=>{e.removeListener(f)});const x=S(()=>s.value.length||1);return(c,l)=>(g(),h("div",Dt,[(g(!0),h(R,null,q(x.value,i=>(g(),h("div",{key:i-1,class:"whitespace-pre-wrap break-words"},[(g(!0),h(R,null,q(b(i-1),(o,k)=>(g(),h(R,{key:k},[o.style||o.classes?(g(),h("span",{key:0,style:Ce(o.style),class:D(o.classes)},L(o.text),7)):(g(),h(R,{key:1},[N(L(o.text),1)],64))],64))),128))]))),128)),Object.keys(n.inlineImages).length>0?(g(),h("div",qt,[(g(!0),h(R,null,q(n.inlineImages,(i,o)=>(g(),h("img",{key:o,src:i,alt:String(o),class:"max-w-full rounded"},null,8,Bt))),128))])):C("",!0),s.value.length===0&&n.logChunks.length===0?(g(),h("div",Ht," Waiting for output... ")):C("",!0)]))}}),jt={class:"flex flex-col h-full bg-gray-900 rounded-lg overflow-hidden"},Wt={key:0},zt=["innerHTML"],Kt=["srcdoc"],Jt={key:3,class:"mt-4 space-y-2"},Gt=["src","alt"],Xt={key:4,class:"text-gray-500 italic"},Yt={key:0,class:"border-t border-gray-700 p-3 bg-gray-800"},Qt={class:"flex flex-wrap gap-2"},Zt=["href"],en={key:1,class:"border-t border-gray-700 p-3 bg-gray-800"},tn={class:"flex items-center gap-2"},nn={class:"text-gray-400 text-sm"},sn=O({__name:"LogPanel",props:{logChunks:{},outputFormat:{default:"terminal"},inputPrompt:{},downloadableFiles:{default:()=>[]},inlineImages:{default:()=>({})}},emits:["sendInput"],setup(n,{emit:t}){const e=n,s=t,r=$(),u=$(),f=$(""),m=$(!0),v=S(()=>e.logChunks.map(l=>l.text).join(""));H(()=>e.logChunks.length,async()=>{m.value&&(await ie(),w())}),H(()=>e.inputPrompt,l=>{l&&ie(()=>{var i;(i=u.value)==null||i.focus()})});function w(){r.value&&(r.value.scrollTop=r.value.scrollHeight)}function b(){if(!r.value)return;const{scrollTop:l,scrollHeight:i,clientHeight:o}=r.value;m.value=i-l-o<50}function x(){f.value&&(s("sendInput",f.value),f.value="")}function c(l){l.key==="Enter"&&(l.preventDefault(),x())}return oe(()=>{w()}),(l,i)=>(g(),h("div",jt,[y("div",{ref_key:"containerRef",ref:r,class:"flex-1 overflow-auto p-4 font-mono text-sm text-gray-100 whitespace-pre-wrap break-words",onScroll:b},[n.outputFormat==="terminal"||n.outputFormat==="text"?(g(),h("div",Wt,L(v.value),1)):n.outputFormat==="html"?(g(),h("div",{key:1,class:"prose prose-invert max-w-none",innerHTML:v.value},null,8,zt)):n.outputFormat==="html_iframe"?(g(),h("iframe",{key:2,srcdoc:v.value,class:"w-full h-full border-0 bg-white"},null,8,Kt)):C("",!0),Object.keys(n.inlineImages).length>0?(g(),h("div",Jt,[(g(!0),h(R,null,q(n.inlineImages,(o,k)=>(g(),h("img",{key:k,src:o,alt:k,class:"max-w-full rounded"},null,8,Gt))),128))])):C("",!0),n.logChunks.length===0?(g(),h("div",Xt," Waiting for output... ")):C("",!0)],544),n.downloadableFiles.length>0?(g(),h("div",Yt,[i[3]||(i[3]=y("div",{class:"text-xs text-gray-400 mb-2"},"Downloadable files:",-1)),y("div",Qt,[(g(!0),h(R,null,q(n.downloadableFiles,o=>(g(),h("a",{key:o.url,href:o.url,download:"",class:"inline-flex items-center gap-1 px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded text-xs text-gray-200 transition-colors"},[i[2]||(i[2]=y("span",{class:"material-icons text-sm"},"download",-1)),N(" "+L(o.filename),1)],8,Zt))),128))])])):C("",!0),n.inputPrompt?(g(),h("div",en,[y("div",tn,[y("span",nn,L(n.inputPrompt),1),X(y("input",{ref_key:"inputRef",ref:u,"onUpdate:modelValue":i[0]||(i[0]=o=>f.value=o),type:"text",class:"flex-1 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-gray-100 text-sm focus:outline-none focus:border-primary",onKeydown:c},null,544),[[Se,f.value]]),y("button",{class:"px-3 py-1 bg-primary hover:bg-primary-dark text-white text-sm rounded transition-colors",onClick:x}," Send ")])])):C("",!0),m.value?C("",!0):(g(),h("button",{key:2,class:"absolute bottom-20 right-4 p-2 bg-gray-700 hover:bg-gray-600 rounded-full shadow-lg transition-colors",title:"Scroll to bottom",onClick:i[1]||(i[1]=o=>{m.value=!0,w()})},[...i[4]||(i[4]=[y("span",{class:"material-icons text-gray-300"},"arrow_downward",-1)])]))]))}}),ln={class:"flex flex-col h-full"},rn={class:"flex-none border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900"},an={class:"flex items-center justify-between px-4 py-3"},on={class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},un={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},cn={class:"flex items-center gap-3"},dn={class:"flex rounded-lg bg-gray-100 dark:bg-gray-800 p-1"},fn=["disabled"],gn={key:0,class:"material-icons text-base animate-spin"},hn={key:1,class:"material-icons text-base"},mn={key:0,class:"flex-1 flex items-center justify-center"},pn={key:1,class:"flex-1 flex items-center justify-center"},yn={class:"text-center"},vn={class:"text-red-500 mt-2"},xn={key:2,class:"flex-1 overflow-hidden"},bn={class:"h-full overflow-auto p-4"},kn={class:"max-w-2xl mx-auto"},wn={key:0,class:"mt-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400"},_n={class:"h-full"},Cn={key:0,class:"h-full"},Sn={class:"h-full bg-gray-900 p-4 overflow-auto"},Ln={key:0,class:"absolute bottom-0 left-0 right-0 border-t border-gray-700 bg-gray-800 p-3"},$n={class:"flex items-center gap-2"},Pn={class:"text-gray-400 text-sm"},En={key:1,class:"h-full flex items-center justify-center bg-gray-100 dark:bg-gray-800"},Vn=O({__name:"ScriptView",props:{scriptName:{}},setup(n){const t=n,e=ee(),s=ce(),r=de(),{config:u,loading:f,error:m,connected:v,outputFormat:w}=U(e),{isValid:b}=U(s),{selectedExecution:x}=U(r),c=$(!1),l=$(null),i=$("form");H(()=>x.value,E=>{E&&(E.status==="executing"||E.status==="initializing")&&(i.value="output")}),H(()=>t.scriptName,E=>{E&&(e.connect(E),s.reset(),i.value="form")},{immediate:!0}),ue(()=>{e.disconnect()});async function o(){if(!(!b.value||c.value)){c.value=!0,l.value=null;try{const E=s.buildFormData();await r.startExecution(t.scriptName,E),i.value="output"}catch(E){l.value=E instanceof Error?E.message:"Failed to start execution"}finally{c.value=!1}}}function k(E){x.value&&r.sendInput(x.value.id,E)}async function d(){if(x.value)try{await r.stopExecution(x.value.id)}catch(E){console.error("Failed to stop execution:",E)}}async function a(){if(x.value)try{await r.killExecution(x.value.id)}catch(E){console.error("Failed to kill execution:",E)}}function p(){i.value="form"}function _(){i.value="output"}const A=S(()=>v.value&&b.value&&!c.value),me=S(()=>{var E,P;return((E=x.value)==null?void 0:E.status)==="executing"||((P=x.value)==null?void 0:P.status)==="initializing"});return(E,P)=>{var ne,se;return g(),h("div",ln,[y("div",rn,[y("div",an,[y("div",null,[y("h1",on,L(((ne=T(u))==null?void 0:ne.name)||n.scriptName),1),(se=T(u))!=null&&se.description?(g(),h("p",un,L(T(u).description),1)):C("",!0)]),y("div",cn,[y("div",dn,[y("button",{class:D(["px-3 py-1 text-sm rounded-md transition-colors",i.value==="form"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"]),onClick:p},[...P[3]||(P[3]=[y("span",{class:"material-icons text-base mr-1 align-text-bottom"},"tune",-1),N(" Parameters ",-1)])],2),y("button",{class:D(["px-3 py-1 text-sm rounded-md transition-colors",i.value==="output"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"]),onClick:_},[...P[4]||(P[4]=[y("span",{class:"material-icons text-base mr-1 align-text-bottom"},"terminal",-1),N(" Output ",-1)])],2)]),me.value?(g(),h(R,{key:0},[y("button",{class:"px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg transition-colors flex items-center gap-2",onClick:d},[...P[5]||(P[5]=[y("span",{class:"material-icons text-base"},"stop",-1),N(" Stop ",-1)])]),y("button",{class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors flex items-center gap-2",onClick:a},[...P[6]||(P[6]=[y("span",{class:"material-icons text-base"},"close",-1),N(" Kill ",-1)])])],64)):(g(),h("button",{key:1,class:"px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!A.value,onClick:o},[c.value?(g(),h("span",gn,"sync")):(g(),h("span",hn,"play_arrow")),N(" "+L(c.value?"Starting...":"Execute"),1)],8,fn))])]),Y(_t)]),T(f)?(g(),h("div",mn,[...P[7]||(P[7]=[y("div",{class:"text-center"},[y("span",{class:"material-icons text-4xl text-primary animate-spin"},"sync"),y("p",{class:"text-gray-500 dark:text-gray-400 mt-2"},"Loading script configuration...")],-1)])])):T(m)?(g(),h("div",pn,[y("div",yn,[P[8]||(P[8]=y("span",{class:"material-icons text-4xl text-red-500"},"error",-1)),y("p",vn,L(T(m)),1),y("button",{class:"mt-4 px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg transition-colors",onClick:P[0]||(P[0]=J=>T(e).connect(n.scriptName))}," Retry ")])])):(g(),h("div",xn,[X(y("div",bn,[y("div",kn,[Y(yt),l.value?(g(),h("div",wn,L(l.value),1)):C("",!0)])],512),[[ae,i.value==="form"]]),X(y("div",_n,[T(x)?(g(),h("div",Cn,[y("div",Sn,[T(w)==="terminal"?(g(),G(Ut,{key:0,"log-chunks":T(x).logChunks,"inline-images":T(x).inlineImages},null,8,["log-chunks","inline-images"])):(g(),G(sn,{key:1,"log-chunks":T(x).logChunks,"output-format":T(w),"input-prompt":T(x).inputPromptText,"downloadable-files":T(x).downloadableFiles,"inline-images":T(x).inlineImages,onSendInput:k},null,8,["log-chunks","output-format","input-prompt","downloadable-files","inline-images"]))]),T(x).inputPromptText&&T(w)==="terminal"?(g(),h("div",Ln,[y("div",$n,[y("span",Pn,L(T(x).inputPromptText),1),y("input",{type:"text",class:"flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded text-gray-100 text-sm focus:outline-none focus:border-primary",onKeydown:P[1]||(P[1]=Le(J=>{k(J.target.value),J.target.value=""},["enter"]))},null,32),y("button",{class:"px-4 py-2 bg-primary hover:bg-primary-dark text-white text-sm rounded transition-colors",onClick:P[2]||(P[2]=J=>{var le;return k(((le=E.$refs.inputField)==null?void 0:le.value)||"")})}," Send ")])])):C("",!0)])):(g(),h("div",En,[...P[9]||(P[9]=[y("div",{class:"text-center text-gray-500 dark:text-gray-400"},[y("span",{class:"material-icons text-4xl mb-2"},"terminal"),y("p",null,"No active execution"),y("p",{class:"text-sm mt-1"},'Click "Execute" to run the script')],-1)])]))],512),[[ae,i.value==="output"]])]))])}}}),Rn=O({__name:"ScriptView",setup(n){const t=ve(),e=S(()=>t.params.name);return(s,r)=>(g(),G(xe,null,{content:$e(()=>[Y(Vn,{"script-name":e.value},null,8,["script-name"])]),_:1}))}});export{Rn as default};
